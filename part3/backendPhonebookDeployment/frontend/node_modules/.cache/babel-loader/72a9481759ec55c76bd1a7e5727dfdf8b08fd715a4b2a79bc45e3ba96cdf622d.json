{"ast":null,"code":"import{useState,useEffect}from'react';import Filter from'./components/Filter';import PersonForm from'./components/PersonForm';import Persons from'./components/Persons';import personsService from'./services/persons';import Notification from'./components/Notification';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[persons,setPersons]=useState([]);const[newName,setNewName]=useState('');const[newNumber,setNumber]=useState('');const[filter,setFilter]=useState('');const[addPersonMessage,setAddPersonMessage]=useState(null);const[isSuccess,setIsSuccess]=useState(true);useEffect(()=>{personsService.getAll().then(response=>{setPersons(response.data);}).catch(error=>{console.error('Error fetching persons:',error);});},[]);console.log('render',persons.length,'persons');const handleNameChange=event=>setNewName(event.target.value);const handleNumberChange=event=>setNumber(event.target.value);const handleFilterChange=event=>setFilter(event.target.value);const personsToShow=persons.filter(person=>person.name&&person.name.toLowerCase().includes(filter.toLowerCase()));const resetForm=()=>{setNewName('');setNumber('');};const displayNotification=(message,success)=>{setAddPersonMessage(message);setIsSuccess(success);setTimeout(()=>{setAddPersonMessage(null);},5000);};const addNewName=event=>{event.preventDefault();const newPerson={name:newName,number:newNumber};if(checkSameName){updatePerson(checkSameName.id,newPerson);}else{personsService.create(newPerson).then(response=>{setPersons(persons.concat(response.data));displayNotification(`Added ${newPerson.name}`,true);resetForm();});}};const checkSameName=persons.some(person=>person.name===newName);const updatePerson=(id,newPerson)=>{const existingPerson=persons.find(person=>person.name===newPerson.name);if(window.confirm(`${newPerson.name} is already added to phonebook, replace the old number with a new one?`)){personsService.update(existingPerson.id,newPerson).then(response=>{displayNotification(`Modified phone number ${newPerson.name}`,true);setPersons(persons.map(p=>p.id!==existingPerson.id?p:response.data));resetForm();}).catch(error=>{displayNotification(`Error updating ${newPerson.name}. It might have been removed from the server.`,false);setPersons(persons.filter(p=>p.id!==id));});}};const handleDeleteChange=id=>{const person=persons.find(p=>p.id===id);console.log(\"holaaa\");console.log(person);if(window.confirm(`Delete ${person.name}?`)){personsService.deletePerson(id).then(()=>{setPersons(persons.filter(p=>p.id!==id));displayNotification(`Deleted ${person.name}`,true);}).catch(error=>{if(error.response&&error.response.status===404){displayNotification(`Information of ${person.name} has already been removed from server`,false);setPersons(persons.filter(p=>p.id!==id));}});}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Phonebook\"}),addPersonMessage&&/*#__PURE__*/_jsx(Notification,{message:addPersonMessage,isSuccess:isSuccess}),/*#__PURE__*/_jsx(Filter,{filter:filter,handleFilterChange:handleFilterChange}),/*#__PURE__*/_jsx(\"h2\",{children:\"Add a new\"}),/*#__PURE__*/_jsx(PersonForm,{newName:newName,newNumber:newNumber,handleNameChange:handleNameChange,handleNumberChange:handleNumberChange,addNewName:addNewName}),/*#__PURE__*/_jsx(\"h2\",{children:\"Numbers\"}),/*#__PURE__*/_jsx(Persons,{persons:personsToShow,handleDelete:handleDeleteChange})]});};export default App;","map":{"version":3,"names":["useState","useEffect","Filter","PersonForm","Persons","personsService","Notification","jsx","_jsx","jsxs","_jsxs","App","persons","setPersons","newName","setNewName","newNumber","setNumber","filter","setFilter","addPersonMessage","setAddPersonMessage","isSuccess","setIsSuccess","getAll","then","response","data","catch","error","console","log","length","handleNameChange","event","target","value","handleNumberChange","handleFilterChange","personsToShow","person","name","toLowerCase","includes","resetForm","displayNotification","message","success","setTimeout","addNewName","preventDefault","newPerson","number","checkSameName","updatePerson","id","create","concat","some","existingPerson","find","window","confirm","update","map","p","handleDeleteChange","deletePerson","status","children","handleDelete"],"sources":["D:/Proyectos/Curso Fullstack/Course-Full-Stack-Open/part3/backendPhonebookDeployment/frontend/src/App.js"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport Filter from './components/Filter'\nimport PersonForm from './components/PersonForm'\nimport Persons from './components/Persons'\nimport personsService from './services/persons'\nimport Notification from './components/Notification'\n\nconst App = () => {\n  const [persons, setPersons] = useState([])\n  const [newName, setNewName] = useState('')\n  const [newNumber, setNumber] = useState('')\n  const [filter, setFilter] = useState('')\n  const [addPersonMessage, setAddPersonMessage] = useState(null);\n  const [isSuccess, setIsSuccess] = useState(true)\n\n  useEffect(() => {\n    personsService\n        .getAll()\n        .then(response => {\n          setPersons(response.data);\n        })\n        .catch(error => {\n          console.error('Error fetching persons:', error);\n        });\n  }, []);\n  \n  console.log('render', persons.length, 'persons')\n\n  const handleNameChange = (event) => setNewName(event.target.value);\n  const handleNumberChange = (event) => setNumber(event.target.value);\n  const handleFilterChange = (event) => setFilter(event.target.value);\n  \n  const personsToShow = persons.filter(person => \n    person.name && person.name.toLowerCase().includes(filter.toLowerCase())\n  );\n  \n  const resetForm = () => {\n    setNewName('')\n    setNumber('')\n  }\n\n  const displayNotification = (message, success) => {\n    setAddPersonMessage(message);\n    setIsSuccess(success);\n    setTimeout(() => {\n      setAddPersonMessage(null);\n    }, 5000);\n  }\n  \n  const addNewName = (event) => {\n    event.preventDefault() \n    const newPerson = { name: newName, number: newNumber }\n    if (checkSameName) {\n      updatePerson(checkSameName.id, newPerson)\n    } else {\n      personsService\n        .create(newPerson)\n        .then(response => {\n          setPersons(persons.concat(response.data));\n          displayNotification(`Added ${newPerson.name}`, true);\n          resetForm()\n      });\n    }\n  }\n\n  const checkSameName = persons.some(person => person.name === newName);\n\n  const updatePerson = (id, newPerson) => {\n    const existingPerson = persons.find(person => person.name === newPerson.name);\n    if(window.confirm(`${newPerson.name} is already added to phonebook, replace the old number with a new one?`)) {\n      personsService\n        .update(existingPerson.id, newPerson)\n        .then(response => {\n            displayNotification(`Modified phone number ${newPerson.name}`, true);\n            setPersons(persons.map(p => (p.id !== existingPerson.id ? p : response.data)));\n            resetForm()\n      })\n      .catch(error => {\n        displayNotification(`Error updating ${newPerson.name}. It might have been removed from the server.`, false)\n        setPersons(persons.filter(p => p.id !== id));\n      });\n    }\n  }\n\n  const handleDeleteChange = (id) => {\n    const person = persons.find(p => p.id === id)\n    console.log(\"holaaa\")\n    console.log(person)\n    if(window.confirm(`Delete ${person.name}?`)) {\n      personsService\n      .deletePerson(id)\n      .then(() => {\n        setPersons(persons.filter(p => p.id !== id));\n        displayNotification(`Deleted ${person.name}`, true);\n      })\n      .catch(error => {\n        if (error.response && error.response.status === 404) {\n          displayNotification(`Information of ${person.name} has already been removed from server`, false)\n          setPersons(persons.filter(p => p.id !== id));\n        }\n      }); \n    }\n    \n  }\n\n  return (\n    <div>\n      <h2>Phonebook</h2>\n      {addPersonMessage && <Notification message={addPersonMessage} isSuccess={isSuccess} />}\n      <Filter filter={ filter } handleFilterChange={ handleFilterChange }/>\n      <h2>Add a new</h2>\n      <PersonForm \n        newName = { newName } \n        newNumber = { newNumber } \n        handleNameChange = { handleNameChange } \n        handleNumberChange = { handleNumberChange } \n        addNewName = { addNewName } \n      />\n      <h2>Numbers</h2>\n      <Persons persons={personsToShow} handleDelete={handleDeleteChange} />\n    </div>\n  )\n}\n\nexport default App"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}