{"ast":null,"code":"import{useState,useEffect}from'react';import Filter from'./components/Filter';import PersonForm from'./components/PersonForm';import Persons from'./components/Persons';import personsService from'./services/persons';import Notification from'./components/Notification';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const App=()=>{const[persons,setPersons]=useState([]);const[newName,setNewName]=useState('');const[newNumber,setNumber]=useState('');const[filter,setFilter]=useState('');const[addPersonMessage,setAddPersonMessage]=useState(null);const[isSuccess,setIsSuccess]=useState(true);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{personsService.getAll().then(response=>{setPersons(response.data);setLoading(false);}).catch(error=>{console.error('Error fetching persons:',error);setError('Error fetching persons');setLoading(false);});},[]);console.log('render',persons.length,'persons');if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}if(error){return/*#__PURE__*/_jsx(\"div\",{children:error});}const handleNameChange=event=>setNewName(event.target.value);const handleNumberChange=event=>setNumber(event.target.value);const handleFilterChange=event=>setFilter(event.target.value);const personsToShow=persons.filter(person=>person.name&&person.name.toLowerCase().includes(filter.toLowerCase()));const resetForm=()=>{setNewName('');setNumber('');};const displayNotification=(message,success)=>{setAddPersonMessage(message);setIsSuccess(success);setTimeout(()=>{setAddPersonMessage(null);},5000);};const addNewName=event=>{event.preventDefault();const newPerson={name:newName,number:newNumber};if(checkSameName){updatePerson(checkSameName.id,newPerson);}else{personsService.create(newPerson).then(response=>{setPersons(persons.concat(response.data));displayNotification(`Added ${newPerson.name}`,true);resetForm();});}};const checkSameName=persons.some(person=>person.name===newName);const updatePerson=(id,newPerson)=>{const existingPerson=persons.find(person=>person.name===newPerson.name);if(window.confirm(`${newPerson.name} is already added to phonebook, replace the old number with a new one?`)){personsService.update(existingPerson.id,newPerson).then(response=>{displayNotification(`Modified phone number ${newPerson.name}`,true);setPersons(persons.map(p=>p.id!==existingPerson.id?p:response.data));resetForm();}).catch(error=>{displayNotification(`Error updating ${newPerson.name}. It might have been removed from the server.`,false);setPersons(persons.filter(p=>p.id!==id));});}};const handleDeleteChange=id=>{const person=persons.find(p=>p.id===id);console.log(\"holaaa\");console.log(person);if(window.confirm(`Delete ${person.name}?`)){personsService.deletePerson(id).then(()=>{setPersons(persons.filter(p=>p.id!==id));displayNotification(`Deleted ${person.name}`,true);}).catch(error=>{if(error.response&&error.response.status===404){displayNotification(`Information of ${person.name} has already been removed from server`,false);setPersons(persons.filter(p=>p.id!==id));}});}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Phonebook\"}),addPersonMessage&&/*#__PURE__*/_jsx(Notification,{message:addPersonMessage,isSuccess:isSuccess}),/*#__PURE__*/_jsx(Filter,{filter:filter,handleFilterChange:handleFilterChange}),/*#__PURE__*/_jsx(\"h2\",{children:\"Add a new\"}),/*#__PURE__*/_jsx(PersonForm,{newName:newName,newNumber:newNumber,handleNameChange:handleNameChange,handleNumberChange:handleNumberChange,addNewName:addNewName}),/*#__PURE__*/_jsx(\"h2\",{children:\"Numbers\"}),/*#__PURE__*/_jsx(Persons,{persons:personsToShow,handleDelete:handleDeleteChange})]});};export default App;","map":{"version":3,"names":["useState","useEffect","Filter","PersonForm","Persons","personsService","Notification","jsx","_jsx","jsxs","_jsxs","App","persons","setPersons","newName","setNewName","newNumber","setNumber","filter","setFilter","addPersonMessage","setAddPersonMessage","isSuccess","setIsSuccess","loading","setLoading","error","setError","getAll","then","response","data","catch","console","log","length","children","handleNameChange","event","target","value","handleNumberChange","handleFilterChange","personsToShow","person","name","toLowerCase","includes","resetForm","displayNotification","message","success","setTimeout","addNewName","preventDefault","newPerson","number","checkSameName","updatePerson","id","create","concat","some","existingPerson","find","window","confirm","update","map","p","handleDeleteChange","deletePerson","status","handleDelete"],"sources":["D:/Proyectos/Curso Fullstack/Course-Full-Stack-Open/part3/backendPhonebookDeployment/frontend/src/App.js"],"sourcesContent":["import { useState, useEffect } from 'react'\nimport Filter from './components/Filter'\nimport PersonForm from './components/PersonForm'\nimport Persons from './components/Persons'\nimport personsService from './services/persons'\nimport Notification from './components/Notification'\n\nconst App = () => {\n  const [persons, setPersons] = useState([])\n  const [newName, setNewName] = useState('')\n  const [newNumber, setNumber] = useState('')\n  const [filter, setFilter] = useState('')\n  const [addPersonMessage, setAddPersonMessage] = useState(null);\n  const [isSuccess, setIsSuccess] = useState(true)\n\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    personsService\n        .getAll()\n        .then(response => {\n          setPersons(response.data);\n          setLoading(false);\n        })\n        .catch(error => {\n          console.error('Error fetching persons:', error);\n          setError('Error fetching persons');\n          setLoading(false); \n        });\n  }, []);\n  \n  console.log('render', persons.length, 'persons')\n\n  if (loading) {\n    return <div>Loading...</div>; \n  }\n\n  if (error) {\n    return <div>{error}</div>; \n  }\n\n  const handleNameChange = (event) => setNewName(event.target.value);\n  const handleNumberChange = (event) => setNumber(event.target.value);\n  const handleFilterChange = (event) => setFilter(event.target.value);\n  \n  const personsToShow = persons.filter(person => \n    person.name && person.name.toLowerCase().includes(filter.toLowerCase())\n  );\n  \n  const resetForm = () => {\n    setNewName('')\n    setNumber('')\n  }\n\n  const displayNotification = (message, success) => {\n    setAddPersonMessage(message);\n    setIsSuccess(success);\n    setTimeout(() => {\n      setAddPersonMessage(null);\n    }, 5000);\n  }\n  \n  const addNewName = (event) => {\n    event.preventDefault() \n    const newPerson = { name: newName, number: newNumber }\n    if (checkSameName) {\n      updatePerson(checkSameName.id, newPerson)\n    } else {\n      personsService\n        .create(newPerson)\n        .then(response => {\n          setPersons(persons.concat(response.data));\n          displayNotification(`Added ${newPerson.name}`, true);\n          resetForm()\n      });\n    }\n  }\n\n  const checkSameName = persons.some(person => person.name === newName);\n\n  const updatePerson = (id, newPerson) => {\n    const existingPerson = persons.find(person => person.name === newPerson.name);\n    if(window.confirm(`${newPerson.name} is already added to phonebook, replace the old number with a new one?`)) {\n      personsService\n        .update(existingPerson.id, newPerson)\n        .then(response => {\n            displayNotification(`Modified phone number ${newPerson.name}`, true);\n            setPersons(persons.map(p => (p.id !== existingPerson.id ? p : response.data)));\n            resetForm()\n      })\n      .catch(error => {\n        displayNotification(`Error updating ${newPerson.name}. It might have been removed from the server.`, false)\n        setPersons(persons.filter(p => p.id !== id));\n      });\n    }\n  }\n\n  const handleDeleteChange = (id) => {\n    const person = persons.find(p => p.id === id)\n    console.log(\"holaaa\")\n    console.log(person)\n    if(window.confirm(`Delete ${person.name}?`)) {\n      personsService\n      .deletePerson(id)\n      .then(() => {\n        setPersons(persons.filter(p => p.id !== id));\n        displayNotification(`Deleted ${person.name}`, true);\n      })\n      .catch(error => {\n        if (error.response && error.response.status === 404) {\n          displayNotification(`Information of ${person.name} has already been removed from server`, false)\n          setPersons(persons.filter(p => p.id !== id));\n        }\n      }); \n    }\n    \n  }\n\n  return (\n    <div>\n      <h2>Phonebook</h2>\n      {addPersonMessage && <Notification message={addPersonMessage} isSuccess={isSuccess} />}\n      <Filter filter={ filter } handleFilterChange={ handleFilterChange }/>\n      <h2>Add a new</h2>\n      <PersonForm \n        newName = { newName } \n        newNumber = { newNumber } \n        handleNameChange = { handleNameChange } \n        handleNumberChange = { handleNumberChange } \n        addNewName = { addNewName } \n      />\n      <h2>Numbers</h2>\n      <Persons persons={personsToShow} handleDelete={handleDeleteChange} />\n    </div>\n  )\n}\n\nexport default App"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}